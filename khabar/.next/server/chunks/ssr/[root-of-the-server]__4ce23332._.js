module.exports=[51793,(a,b,c)=>{"use strict";b.exports=a.r(37147).vendored["react-ssr"].React},308,(a,b,c)=>{"use strict";b.exports=a.r(37147).vendored.contexts.AppRouterContext},42220,(a,b,c)=>{"use strict";b.exports=a.r(37147).vendored["react-ssr"].ReactServerDOMTurbopackClient},21874,(a,b,c)=>{"use strict";b.exports=a.r(37147).vendored.contexts.HooksClientContext},20916,(a,b,c)=>{"use strict";b.exports=a.r(37147).vendored.contexts.ServerInsertedHtml},18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},37147,(a,b,c)=>{"use strict";b.exports=a.r(18622)},36354,(a,b,c)=>{"use strict";b.exports=a.r(37147).vendored["react-ssr"].ReactJsxRuntime},5838,(a,b,c)=>{"use strict";b.exports=a.r(37147).vendored["react-ssr"].ReactDOM},97818,a=>{"use strict";let b=(0,a.i(54168).default)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);a.s(["ArrowRight",()=>b],97818)},29848,a=>{"use strict";let b=(0,a.i(54168).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],29848)},34742,a=>{"use strict";let b=(0,a.i(54168).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);a.s(["Save",()=>b],34742)},86982,a=>{"use strict";var b=a.i(36354),c=a.i(51793),d=a.i(97818),e=a.i(37445);let f=(0,a.i(54168).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var g=a.i(29848),h=a.i(34742),i=a.i(95711),j=a.i(81712);function k(){let[k,l]=(0,c.useState)(1),[m,n]=(0,c.useState)("both"),[o,p]=(0,c.useState)({start:"",end:""}),[q,r]=(0,c.useState)(""),[s,t]=(0,c.useState)(""),[u,v]=(0,c.useState)(""),[w,x]=(0,c.useState)(""),[y,z]=(0,c.useState)(""),[A,B]=(0,c.useState)(!1),[C,D]=(0,c.useState)([]),[E,F]=(0,c.useState)([]),[G,H]=(0,c.useState)(!1),[I,J]=(0,c.useState)(""),[K,L]=(0,c.useState)("");(0,c.useEffect)(()=>{r(localStorage.getItem("gemini_api_key")||""),t(localStorage.getItem("sif_keywords")||"Secours Islamique France"),v(localStorage.getItem("sif_islam_keywords")||"Islam en France, musulmans"),x(localStorage.getItem("sif_news_prompt")||"Fais une courte synthèse très factuelle de cet article en 2 phrases."),z(localStorage.getItem("sif_social_prompt")||"Analyse ces tweets et dégage les thèmes, le ton, et les statistiques.")},[]);let M=async a=>{if(!q)throw Error("Veuillez configurer votre clé API Gemini dans les paramètres.");let b=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-3.0-flash:generateContent?key=${q}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:a}]}],generationConfig:{temperature:.2}})});if(!b.ok){let a=await b.json();throw Error(a.error?.message||"Erreur de l'API Gemini")}return(await b.json()).candidates[0].content.parts[0].text},N=async a=>{let b=new URLSearchParams;b.append("q",a),o.start&&b.append("start",o.start),o.end&&b.append("end",o.end);let c=await fetch(`/api/news?${b.toString()}`);if(!c.ok)throw Error("Erreur lors de la récupération des actualités");let d=(await c.json()).articles;return await Promise.all(d.map(async a=>{try{let b=`Voici un titre d'article et potentiellement son origine :
Titre : ${a.title}
Source : ${a.source}
Date : ${a.pubDate}

Instructions : ${w}`,c=await M(b);return{...a,synthesis:c}}catch(b){return{...a,synthesis:"Impossible de générer la synthèse."}}}))},O=async()=>{B(!0);try{let[a,b]=await Promise.all([N(s),N(u)]);D(a),F(b)}catch(a){alert(a instanceof Error?a.message:"Erreur inconnue")}finally{B(!1)}},P=async()=>{H(!0);try{let a=`Voici des donn\xe9es brutes copi\xe9es depuis les r\xe9seaux sociaux :

${I}

Instructions : ${y}`,b=await M(a);L(b)}catch(a){alert(a instanceof Error?a.message:"Erreur inconnue")}finally{H(!1)}},Q=(a,c,d)=>(0,b.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:a.map((a,e)=>(0,b.jsxs)("div",{style:{padding:"1rem",border:"1px solid var(--border)",borderRadius:"var(--radius-md)"},children:[(0,b.jsx)("h4",{style:{color:"var(--primary)",marginBottom:"0.25rem"},children:a.title}),(0,b.jsxs)("div",{style:{fontSize:"0.85rem",color:"var(--text-muted)",marginBottom:"0.75rem"},children:[a.source," - ",new Date(a.pubDate).toLocaleDateString()]}),(0,b.jsx)("textarea",{className:"form-control",value:a.synthesis,onChange:a=>{let b=[...c];b[e].synthesis=a.target.value,d(b)},rows:4}),(0,b.jsx)("a",{href:a.link,target:"_blank",rel:"noreferrer",style:{fontSize:"0.85rem",color:"var(--primary)",display:"inline-block",marginTop:"0.5rem"},children:"Lire l'article original"})]},e))});return(0,b.jsxs)("div",{className:"report-builder",children:[(0,b.jsx)("div",{style:{display:"flex",marginBottom:"2rem",gap:"1rem"},className:"no-print",children:[1,2,3,4].map(a=>(0,b.jsx)("div",{style:{flex:1,height:"8px",backgroundColor:a<=k?"var(--primary)":"var(--border)",borderRadius:"4px",transition:"all 0.3s"}},a))}),1===k&&(0,b.jsxs)("div",{className:"card no-print",children:[(0,b.jsx)("h2",{style:{marginBottom:"1.5rem"},children:"1. Configuration du Rapport"}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{className:"form-label",children:"Type de Rapport"}),(0,b.jsx)("div",{style:{display:"flex",gap:"1rem"},children:["media","social","both"].map(a=>(0,b.jsxs)("button",{onClick:()=>n(a),className:`btn ${m===a?"btn-primary":"btn-outline"}`,style:{flex:1},children:["media"===a&&"Médias Uniquement","social"===a&&"Réseaux Sociaux Uniquement","both"===a&&"Complet (Médias + Réseaux)"]},a))})]}),(0,b.jsxs)("div",{className:"form-group",style:{display:"flex",gap:"1rem",marginTop:"1.5rem"},children:[(0,b.jsxs)("div",{style:{flex:1},children:[(0,b.jsx)("label",{className:"form-label",children:"Date de début"}),(0,b.jsx)("input",{type:"date",className:"form-control",value:o.start,onChange:a=>p({...o,start:a.target.value})})]}),(0,b.jsxs)("div",{style:{flex:1},children:[(0,b.jsx)("label",{className:"form-label",children:"Date de fin"}),(0,b.jsx)("input",{type:"date",className:"form-control",value:o.end,onChange:a=>p({...o,end:a.target.value})})]})]}),!q&&(0,b.jsx)("div",{style:{marginTop:"1rem",padding:"1rem",backgroundColor:"#fef2f2",color:"#b91c1c",borderRadius:"8px"},children:"Attention : Votre clé API Gemini n'est pas configurée. Vous ne pourrez pas générer d'analyses."}),(0,b.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"2rem"},children:(0,b.jsxs)("button",{className:"btn btn-primary",onClick:()=>l("social"===m?3:2),disabled:!o.start||!o.end,children:["Suivant ",(0,b.jsx)(d.ArrowRight,{size:18})]})})]}),2===k&&("media"===m||"both"===m)&&(0,b.jsxs)("div",{className:"card no-print",children:[(0,b.jsx)("h2",{style:{marginBottom:"1.5rem"},children:"2. Veille Médias (Google News)"}),0===C.length&&0===E.length?(0,b.jsx)("div",{style:{padding:"3rem",textAlign:"center",border:"1px dashed var(--border)",borderRadius:"var(--radius-md)"},children:(0,b.jsx)("button",{className:"btn btn-primary",onClick:O,disabled:A,children:A?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(g.Loader2,{className:"animate-spin",size:18})," Scraping et Analyse en cours..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(f,{size:18})," Lancer la recherche Google News"]})})}):(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,b.jsx)("h3",{style:{marginBottom:"1rem",color:"#004b7c",paddingBottom:"0.5rem",borderBottom:"2px solid #007fb5"},children:"Retombées Association"}),C.length>0?Q(C,C,D):(0,b.jsx)("p",{className:"text-muted",children:"Aucun article trouvé."})]}),(0,b.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,b.jsx)("h3",{style:{marginBottom:"1rem",color:"#004b7c",paddingBottom:"0.5rem",borderBottom:"2px solid #007fb5"},children:"Actualités Nationales (Islam en France)"}),E.length>0?Q(E,E,F):(0,b.jsx)("p",{className:"text-muted",children:"Aucun article trouvé."})]})]}),(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"2rem"},children:[(0,b.jsxs)("button",{className:"btn btn-outline",onClick:()=>l(1),children:[(0,b.jsx)(e.ArrowLeft,{size:18})," Retour"]}),(0,b.jsxs)("button",{className:"btn btn-primary",onClick:()=>l("media"===m?4:3),disabled:0===C.length&&0===E.length,children:["Suivant ",(0,b.jsx)(d.ArrowRight,{size:18})]})]})]}),3===k&&("social"===m||"both"===m)&&(0,b.jsxs)("div",{className:"card no-print",children:[(0,b.jsx)("h2",{style:{marginBottom:"1.5rem"},children:"3. Analyse Réseaux Sociaux"}),(0,b.jsx)("p",{style:{color:"var(--text-muted)",marginBottom:"1.5rem"},children:"Collez ci-dessous les tweets ou posts récupérés pour l'analyse IA."}),(0,b.jsx)("div",{className:"form-group",children:(0,b.jsx)("textarea",{className:"form-control",rows:8,placeholder:"Ex: @utilisateur1: Magnifique action de l'ONG ! @utilisateur2: Je ne comprends pas où va l'argent...",value:I,onChange:a=>J(a.target.value)})}),(0,b.jsx)("button",{className:"btn btn-outline",onClick:P,disabled:!I||G,style:{marginBottom:"1.5rem"},children:G?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(g.Loader2,{className:"animate-spin",size:18})," Analyse en cours..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(f,{size:18})," Générer le rapport IA"]})}),K&&(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{className:"form-label",children:"Synthèse IA (Modifiable)"}),(0,b.jsx)("textarea",{className:"form-control",rows:10,value:K,onChange:a=>L(a.target.value)})]}),(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"2rem"},children:[(0,b.jsxs)("button",{className:"btn btn-outline",onClick:()=>l("social"===m?1:2),children:[(0,b.jsx)(e.ArrowLeft,{size:18})," Retour"]}),(0,b.jsxs)("button",{className:"btn btn-primary",onClick:()=>l(4),disabled:!K,children:["Visualiser le Rapport PDF ",(0,b.jsx)(d.ArrowRight,{size:18})]})]})]}),4===k&&(0,b.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"2rem"},children:[(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"1rem"},className:"no-print",children:[(0,b.jsxs)("button",{className:"btn btn-outline",onClick:()=>l(3),children:[(0,b.jsx)(e.ArrowLeft,{size:18})," Éditer"]}),(0,b.jsxs)("button",{className:"btn btn-outline",onClick:async()=>{try{let{supabase:b}=await a.A(5627),c={report_type:m,date_start:o.start,date_end:o.end,media_articles:C,islam_articles:E,social_analysis:K,created_at:new Date().toISOString()},{error:d}=await b.from("reports").insert([c]);if(d)throw d;alert("Rapport sauvegardé avec succès dans Supabase !")}catch(a){alert("Erreur lors de la sauvegarde Supabase (vérifiez vos clés dans .env.local).")}},children:[(0,b.jsx)(h.Save,{size:18})," Sauvegarder (Supabase)"]}),(0,b.jsxs)("button",{className:"btn btn-primary",onClick:()=>window.print(),children:[(0,b.jsx)(i.Printer,{size:18})," Exporter PDF"]})]}),(0,b.jsx)(j.default,{reportType:m,dateRange:o,mediaArticles:C,islamArticles:E,socialAnalysis:K})]})]})}a.s(["default",()=>k],86982)},5627,a=>{a.v(b=>Promise.all(["server/chunks/ssr/_gemini_antigravity_scratch_khabar_src_utils_supabase_ts_8a19a895._.js"].map(b=>a.l(b))).then(()=>b(69644)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__4ce23332._.js.map